{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState,useRef}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const NewsContext=/*#__PURE__*/createContext();export const NewsProvider=_ref=>{let{children,query,max=null}=_ref;const[articles,setArticles]=useState([]);const[loading,setLoading]=useState(true);const lastSuccessfulArticles=useRef([]);const toSearchQuery=str=>str.replace(/,/g,'').replace(/\\s+/g,'+').replace(/[^\\w+]/g,'');const searchQuery=toSearchQuery(query||'');// Load cached data on mount\nuseEffect(()=>{const cached=localStorage.getItem('cached_news');if(cached){const parsed=JSON.parse(cached);lastSuccessfulArticles.current=parsed;setArticles(parsed);// show cached while loading\n}},[]);useEffect(()=>{if(!searchQuery)return;const fetchNews=async()=>{setLoading(true);try{var _json$articles;let url=\"/api/news?q=\".concat(searchQuery);if(max!==null)url+=\"&max=\".concat(max);const response=await fetch(url);const json=await response.json();if(((_json$articles=json.articles)===null||_json$articles===void 0?void 0:_json$articles.length)>0){setArticles(json.articles);lastSuccessfulArticles.current=json.articles;localStorage.setItem('cached_news',JSON.stringify(json.articles));}else{console.warn('API returned empty, using cached');setArticles(lastSuccessfulArticles.current);}}catch(error){console.error('❌ News fetch failed:',error.message);setArticles(lastSuccessfulArticles.current);}finally{setLoading(false);}};fetchNews();},[searchQuery,max]);return/*#__PURE__*/_jsx(NewsContext.Provider,{value:{articles,loading},children:children});};export const useNews=()=>useContext(NewsContext);","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","useRef","jsx","_jsx","NewsContext","NewsProvider","_ref","children","query","max","articles","setArticles","loading","setLoading","lastSuccessfulArticles","toSearchQuery","str","replace","searchQuery","cached","localStorage","getItem","parsed","JSON","parse","current","fetchNews","_json$articles","url","concat","response","fetch","json","length","setItem","stringify","console","warn","error","message","Provider","value","useNews"],"sources":["/Users/ashwin.r1/Downloads/live-cricket-scores-main/frontend/src/context/NewsContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState, useRef } from 'react';\n\nconst NewsContext = createContext();\n\nexport const NewsProvider = ({ children, query, max = null }) => {\n  const [articles, setArticles] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const lastSuccessfulArticles = useRef([]);\n\n  const toSearchQuery = (str) =>\n    str.replace(/,/g, '').replace(/\\s+/g, '+').replace(/[^\\w+]/g, '');\n\n  const searchQuery = toSearchQuery(query || '');\n\n  // Load cached data on mount\n  useEffect(() => {\n    const cached = localStorage.getItem('cached_news');\n    if (cached) {\n      const parsed = JSON.parse(cached);\n      lastSuccessfulArticles.current = parsed;\n      setArticles(parsed); // show cached while loading\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!searchQuery) return;\n\n    const fetchNews = async () => {\n      setLoading(true);\n      try {\n        let url = `/api/news?q=${searchQuery}`;\n        if (max !== null) url += `&max=${max}`;\n\n        const response = await fetch(url);\n        const json = await response.json();\n\n        if (json.articles?.length > 0) {\n          setArticles(json.articles);\n          lastSuccessfulArticles.current = json.articles;\n          localStorage.setItem('cached_news', JSON.stringify(json.articles));\n        } else {\n          console.warn('API returned empty, using cached');\n          setArticles(lastSuccessfulArticles.current);\n        }\n      } catch (error) {\n        console.error('❌ News fetch failed:', error.message);\n        setArticles(lastSuccessfulArticles.current);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchNews();\n  }, [searchQuery, max]);\n\n  return (\n    <NewsContext.Provider value={{ articles, loading }}>\n      {children}\n    </NewsContext.Provider>\n  );\n};\n\nexport const useNews = () => useContext(NewsContext);\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEtF,KAAM,CAAAC,WAAW,cAAGP,aAAa,CAAC,CAAC,CAEnC,MAAO,MAAM,CAAAQ,YAAY,CAAGC,IAAA,EAAqC,IAApC,CAAEC,QAAQ,CAAEC,KAAK,CAAEC,GAAG,CAAG,IAAK,CAAC,CAAAH,IAAA,CAC1D,KAAM,CAACI,QAAQ,CAAEC,WAAW,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACY,OAAO,CAAEC,UAAU,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAAc,sBAAsB,CAAGb,MAAM,CAAC,EAAE,CAAC,CAEzC,KAAM,CAAAc,aAAa,CAAIC,GAAG,EACxBA,GAAG,CAACC,OAAO,CAAC,IAAI,CAAE,EAAE,CAAC,CAACA,OAAO,CAAC,MAAM,CAAE,GAAG,CAAC,CAACA,OAAO,CAAC,SAAS,CAAE,EAAE,CAAC,CAEnE,KAAM,CAAAC,WAAW,CAAGH,aAAa,CAACP,KAAK,EAAI,EAAE,CAAC,CAE9C;AACAT,SAAS,CAAC,IAAM,CACd,KAAM,CAAAoB,MAAM,CAAGC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC,CAClD,GAAIF,MAAM,CAAE,CACV,KAAM,CAAAG,MAAM,CAAGC,IAAI,CAACC,KAAK,CAACL,MAAM,CAAC,CACjCL,sBAAsB,CAACW,OAAO,CAAGH,MAAM,CACvCX,WAAW,CAACW,MAAM,CAAC,CAAE;AACvB,CACF,CAAC,CAAE,EAAE,CAAC,CAENvB,SAAS,CAAC,IAAM,CACd,GAAI,CAACmB,WAAW,CAAE,OAElB,KAAM,CAAAQ,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5Bb,UAAU,CAAC,IAAI,CAAC,CAChB,GAAI,KAAAc,cAAA,CACF,GAAI,CAAAC,GAAG,gBAAAC,MAAA,CAAkBX,WAAW,CAAE,CACtC,GAAIT,GAAG,GAAK,IAAI,CAAEmB,GAAG,UAAAC,MAAA,CAAYpB,GAAG,CAAE,CAEtC,KAAM,CAAAqB,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACH,GAAG,CAAC,CACjC,KAAM,CAAAI,IAAI,CAAG,KAAM,CAAAF,QAAQ,CAACE,IAAI,CAAC,CAAC,CAElC,GAAI,EAAAL,cAAA,CAAAK,IAAI,CAACtB,QAAQ,UAAAiB,cAAA,iBAAbA,cAAA,CAAeM,MAAM,EAAG,CAAC,CAAE,CAC7BtB,WAAW,CAACqB,IAAI,CAACtB,QAAQ,CAAC,CAC1BI,sBAAsB,CAACW,OAAO,CAAGO,IAAI,CAACtB,QAAQ,CAC9CU,YAAY,CAACc,OAAO,CAAC,aAAa,CAAEX,IAAI,CAACY,SAAS,CAACH,IAAI,CAACtB,QAAQ,CAAC,CAAC,CACpE,CAAC,IAAM,CACL0B,OAAO,CAACC,IAAI,CAAC,kCAAkC,CAAC,CAChD1B,WAAW,CAACG,sBAAsB,CAACW,OAAO,CAAC,CAC7C,CACF,CAAE,MAAOa,KAAK,CAAE,CACdF,OAAO,CAACE,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAACC,OAAO,CAAC,CACpD5B,WAAW,CAACG,sBAAsB,CAACW,OAAO,CAAC,CAC7C,CAAC,OAAS,CACRZ,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDa,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,CAACR,WAAW,CAAET,GAAG,CAAC,CAAC,CAEtB,mBACEN,IAAA,CAACC,WAAW,CAACoC,QAAQ,EAACC,KAAK,CAAE,CAAE/B,QAAQ,CAAEE,OAAQ,CAAE,CAAAL,QAAA,CAChDA,QAAQ,CACW,CAAC,CAE3B,CAAC,CAED,MAAO,MAAM,CAAAmC,OAAO,CAAGA,CAAA,GAAM5C,UAAU,CAACM,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}